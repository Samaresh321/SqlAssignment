Q61. Write an SQL query to report the shortest distance between any two points from the Point table. 

create table point(x int);

insert into point values (-1),(0),(2);

SELECT * from point;

SELECT MIN(ABS(p1.x-p2.x)) as Shortest_Path
FROM point p1
CROSS JOIN point p2
WHERE p1.x <> p2.x ;

Q62.Write a SQL query for a report that provides the pairs (actor_id, director_id) where the actor has cooperated with the director at least three times.
    Return the result table in any order.

create table ActorDirector(actor_id int,director_id int,timestamp int);

insert into ActorDirector values
(1,1,0),
(1,1,1),
(1,1,2),
(1,2,3),
(1,2,4),
(2,1,5),
(2,1,6);

SELECT * from ActorDirector;


select actor_id,director_id 
from (
    select actor_id,director_id,count(*) cooperated ,
    dense_rank() over(order by count(*) desc) rnk FROM
    ActorDirector group by actor_id,director_id)a 
    where a.rnk = 1;

WITH cte AS(select actor_id,director_id,
ROW_NUMBER() over(PARTITION BY actor_id) rnk 
FROM ActorDirector)

SELECT actor_id,director_id 
FROM cte WHERE rnk=3
 ;

SELECT actor_id,director_id
FROM 
ActorDirector
GROUP BY actor_id,director_id
HAVING COUNT(timestamp)>=3;

Q63. Write an SQL query that reports the product_name, year, and price for each sale_id in the Sales table. 
     Return the resulting table in any order.
create  table Sales
(sale_id int, product_id int, year int, quantity int,price int);

insert into Sales values
(1,100,2008,10,5000),
(2,100,2009,12,5000),
(7,200,2011,15,9000);

create table Product
(product_id int,product_name varchar(10));

insert into Product values
(100,'Nokia  '),
(200,'Apple  '),
(300,'Samsung');

SELECT product_name, year, price
FROM Sales s 
INNER JOIN 
Product p ON s.product_id=p.product_id;

Q64.Write an SQL query that reports the average experience years of all the employees for each project, rounded to 2 digits.
     Return the result table in any order.


create table Project
(project_id  int, employee_id int);

insert into Project values
(1,1),
(1,2),
(1,3),
(2,1),
(2,4);

create table Employee
(employee_id int, name   varchar(20), experience_years int);

insert into Employee values
(1,'Khaled',3),
(2,'Ali',2),
(3,'John',1),
(4,'Doe',2);

select project_id , round(avg(experience_years),1) as average_years
from Project  p
left join Employee  e
on p.employee_id = e.employee_id
group by project_id

Q65.Write an SQL query that reports the best seller by total sales price, If there is a tie, report them all.
    Return the result table in any order











